%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\mode<presentation>{\frametitle{\insertsubsection\ -- Objectives}}
\begin{itemize}
\item You will learn to ...
\item ... write actors.
\item ... instanciate actors in a networkgraph.
\item ... run functional simulation.
\end{itemize}
\end{frame}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile=singleslide]
\mode<presentation>{\frametitle{\insertsubsection\ -- Actors}}
\begin{itemize}
\item include SysteMoC library header
\begin{lstlisting}
#include <systemoc/smoc_moc.hpp>
\end{lstlisting}
\item an actor is a C++ class derived from base class \lstinline!smoc_actor!
\begin{lstlisting}
class HelloActor: public smoc_actor {
\end{lstlisting}
\item an action is a member function of the actors class
\item actions shall be \lstinline!private! $\rightarrow$ prohibit execution by others
\begin{lstlisting}
private:
  void src() {   // action
    std::cout << "Actor " << this->name() << " says:\n"
              << "Hello SysteMoC" << std::endl;
  }
\end{lstlisting}
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile=singleslide]
\mode<presentation>{\frametitle{\insertsubsection\ -- Actors}}
\begin{itemize}
\item an actor has a finite set of states
\begin{lstlisting}
  smoc_firing_state state_a, state_b;   // FSM states
\end{lstlisting}
\item like objects of a class in C++, we create instances of an actor
\item constructors are responsible for creating a certain actor instance
\item provide actor name and start state to base class \lstinline!smoc_actor!
\begin{lstlisting}
public:
  // actor constructor
  HelloActor(sc_module_name name)
    : smoc_actor(name, state_a) {
\end{lstlisting}
\item a finite state machine (FSM) defines transitions between states
\item e.g. a transition from \lstinline!state_a! to \lstinline!state_b!
\item if this transition is taken, the action \lstinline!HelloActor::src! is executed
\begin{lstlisting}
  // FSM definition:
  //  transition from state_a to state_b calling action src
  state_a = CALL(HelloActor::src) >> state_b;
\end{lstlisting}
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile=singleslide]
\mode<presentation>{\frametitle{\insertsubsection\ -- Graphs}}
\begin{itemize}
\item a networkgraph is derived from base class \lstinline!smoc_graph!
\begin{lstlisting}
class HelloNetworkGraph: public smoc_graph {
\end{lstlisting}
\item our networkgraph has a instance of the \lstinline!HelloActor!
\begin{lstlisting}
private:
  // actors
  HelloActor     helloActor;
\end{lstlisting}
\item a name for the graph has to be passed to base class \lstinline!smoc_graph!
\item we need to call \lstinline!HelloActor!s constructer
\begin{lstlisting}
public:
  // networkgraph constructor
  HelloNetworkGraph(sc_module_name name)
    : smoc_graph(name),
      helloActor("HalloActor") // create actor HelloWorld
  { }
};
\end{lstlisting}
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[fragile=singleslide]
\mode<presentation>{\frametitle{\insertsubsection\ -- Simulation}}
\begin{itemize}
\item function \lstinline!sc_main! is the entry point for simulation (cf. SystemC)
\item the \lstinline!smoc_top_moc! is typed with our networkgraph
\item parameters are passed to networksgraphs constructor (e.g.``top'')
\item call \lstinline!sc_start! to start simulation (cf. SystemC)
\begin{lstlisting}
int sc_main (int argc, char **argv) {
  // create networkgraph
  smoc_top_moc<HelloNetworkGraph> top("top");

  sc_start();  // start simulation (SystemC)
  return 0;
}
\end{lstlisting}
\item compile the source code
\item execute binary for simulation (OSCI SystemC)
\end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
\mode<presentation>{\frametitle{\insertsubsection\ -- Exercises}}
\begin{itemize}
\item Instanciate some more \lstinline!HelloActor!s. (Use different names).
\item Write your own actor.
\end{itemize}
\end{frame}
