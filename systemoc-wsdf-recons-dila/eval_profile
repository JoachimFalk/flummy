#!/bin/bash

TEMP_FILE1=temp1.txt
TEMP_FILE2=temp2.txt
PROFILE_FLAT_FILE=profile_flat.txt
PROFILE_GRAPH_FILE=profile_graph.txt

RESULT_PROFILE_GRAPH_FILE=profile_graph_excel.txt

# gprof -b -C -p simulation-wsdf-recons-dila > ${PROFILE_FLAT_FILE}

# gprof -C -q simulation-wsdf-recons-dila > ${PROFILE_GRAPH_FILE}


# prepare for Excel import (by introducing ;)

#normal line with 3 arguments
sed -e "s/^[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9]*\\/[0-9]*\\)/;;\\1;\2;\3;/" ${PROFILE_GRAPH_FILE} > ${TEMP_FILE1}

#normal line with 3 arguments, but without /
sed -e "s/^[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9]*\\)/;;\\1;\2;\3;/" ${TEMP_FILE1} > ${TEMP_FILE2}

#normal line with a argument
sed -e "s/^[ ][ ]*\\([0-9.][0-9.]*\\)/;;;;\\1;/" ${TEMP_FILE2} > ${TEMP_FILE1}

#separate last [xx] in line
sed -e "s/\\([][0-9]*\\)[ ]*$/;\\1/" ${TEMP_FILE1} > ${TEMP_FILE2}

#line introduced with [xx] and 5 arguments
sed -e "s/^[ ]*\\([[][0-9]*[]]\\)[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9.][+0-9.]*\\)/\\1;\\2;\\3;\\4;\\5;/" ${TEMP_FILE2} > ${TEMP_FILE1}

#header
sed -e "s/^Index.*/Index;% Zeit;Selb.;Kinder;aufgerufen;Name/" ${TEMP_FILE1} > ${TEMP_FILE2}

#line introduced with [xx] and 4 arguments
sed -e "s/^[ ]*\\([[][0-9]*[]]\\)[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9.][0-9.]*\\)[ ][ ]*\\([0-9.][0-9.]*\\)/\\1;\\2;\\3;\\4;;/" ${TEMP_FILE2} > ${RESULT_PROFILE_GRAPH_FILE}




# rm -f ${TEMP_FILE1} ${TEMP_FILE2}
